<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <img src="assets/logo.png" alt="KhulaFx" class="header-logo" />
      <div class="header-right">
        <span class="user-name">{{ currentUser?.name }}</span>
        <button class="btn-logout" (click)="logout()">Logout</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <div class="container">
      <h1>Admin Dashboard</h1>

      <!-- Notifier Controls -->
      <div class="card">
        <h2>Notifier Controls</h2>
        <p class="card-subtitle">Enable or disable notification channels in real-time</p>

        @if (notifierSettings.length > 0) {
          <div class="notifier-controls">
            @for (notifier of notifierSettings; track notifier.id) {
              <div class="notifier-item">
                <div class="notifier-info">
                  <h3>{{ notifier.notifierName }} Notifications</h3>
                  <p class="last-updated">Last updated: {{ notifier.lastUpdated | date:'short' }}</p>
                </div>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [checked]="notifier.isEnabled"
                    (change)="toggleNotifier(notifier)"
                    [disabled]="isUpdating">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            }
          </div>
        }

        @if (updateMessage) {
          <div class="update-message" [class.success]="updateSuccess">
            {{ updateMessage }}
          </div>
        }
      </div>

      <!-- Today's Stats -->
      @if (dailyReport) {
        <div class="card">
          <h2>Today's Performance</h2>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value">{{ dailyReport.totalTrades }}</div>
              <div class="stat-label">Total Trades</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ dailyReport.itmCount }}</div>
              <div class="stat-label">ITM</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ dailyReport.otmCount }}</div>
              <div class="stat-label">OTM</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ dailyReport.winRate }}%</div>
              <div class="stat-label">Win Rate</div>
            </div>
          </div>
        </div>
      }

      <!-- Scheduled Reports Info -->
      <div class="card">
        <h2>Scheduled Reports</h2>
        <div class="report-schedule">
          <div class="schedule-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <div>
              <h4>Daily Report</h4>
              <p>Sent every day at 11:58 PM (SAST)</p>
              <button class="btn-trigger-report" (click)="runDailyReportNow()" [disabled]="isRunningDailyReport">
                @if (isRunningDailyReport) {
                  Running...
                } @else {
                  Run Now
                }
              </button>
            </div>
          </div>
          <div class="schedule-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            <div>
              <h4>Weekly Report</h4>
              <p>Sent every Saturday at 10:00 AM (SAST) - Monday to Friday summary</p>
              <button class="btn-trigger-report" (click)="runWeeklyReportNow()" [disabled]="isRunningWeeklyReport">
                @if (isRunningWeeklyReport) {
                  Running...
                } @else {
                  Run Now
                }
              </button>
            </div>
          </div>
        </div>

        @if (reportTriggerMessage) {
          <div class="report-trigger-message" [class.success]="reportTriggerSuccess">
            {{ reportTriggerMessage }}
          </div>
        }
      </div>
    </div>
  </main>
</div>